# version: '3.8'

# services:
#   # Next.js Application
#   app:
#     build:
#       context: .
#       dockerfile: Dockerfile
#     container_name: vitaxir-app
#     restart: unless-stopped
#     ports:
#       - "3000:3000"
#     environment:
#       - NODE_ENV=production
#       - NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL:-http://localhost:8080}
#     volumes:
#       # Mount for hot reload in development (optional)
#       - .:/app
#       - /app/node_modules
#       - /app/.next
#     networks:
#       - vitaxir-network

#   # Development service (for local development with hot reload)
#   app-dev:
#     build:
#       context: .
#       dockerfile: Dockerfile.dev
#     container_name: vitaxir-app-dev
#     restart: unless-stopped
#     ports:
#       - "3001:3000"
#     environment:
#       - NODE_ENV=development
#       - NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL:-http://localhost:8080}
#     volumes:
#       - .:/app
#       - /app/node_modules
#       - /app/.next
#     command: npm run dev
#     networks:
#       - vitaxir-network
#     profiles:
#       - development

# networks:
#   vitaxir-network:
#     driver: bridge

version: "3.8"

services:
  # Next.js Application (Production)
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: vitaxir-app
    restart: unless-stopped
    ports:
      - "3011:3000" # Port 3011 على السيرفر مربوط بالـ container Port 3000
      - "5555:5555"   # <--- أضف هذا السطر

    environment:
      - NODE_ENV=production
      - NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL:-http://159.198.37.52:3010} # الباك على 3010
    # No volumes for production - uses built files from Dockerfile
    networks:
      - vitaxir-network

  # Next.js Application (Development)
  app-dev:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: vitaxir-app-dev
    restart: unless-stopped
    ports:
      - "3012:3000" # Port 3012 على السيرفر للـ dev
    environment:
      - NODE_ENV=development
      - NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL:-http://159.198.37.52:3010}
    volumes:
      - .:/app
      - /app/node_modules
      - /app/.next
    command: npm run dev
    networks:
      - vitaxir-network
    profiles:
      - development

networks:
  vitaxir-network:
    driver: bridge
